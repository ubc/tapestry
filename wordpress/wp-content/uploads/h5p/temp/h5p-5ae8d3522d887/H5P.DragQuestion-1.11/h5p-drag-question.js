!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=3)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=t.curry=function(e){var t=e.length;return function n(){var o=Array.prototype.slice.call(arguments,0);return o.length>=t?e.apply(null,o):function(){var e=Array.prototype.slice.call(arguments,0);return n.apply(null,o.concat(e))}}},i=(t.compose=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})},t.forEach=o(function(e,t){t.forEach(e)}),t.map=o(function(e,t){return t.map(e)}),t.filter=o(function(e,t){return t.filter(e)})),r=(t.some=o(function(e,t){return t.some(e)}),t.contains=o(function(e,t){return-1!=t.indexOf(e)}));t.without=o(function(e,t){return i(function(t){return!r(t,e)},t)}),t.inverseBooleanString=function(e){return("true"!==e).toString()}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createElement=t.toggleClass=t.toggleVisibility=t.show=t.hide=t.removeClass=t.addClass=t.classListContains=t.removeChild=t.querySelectorAll=t.nodeListToArray=t.querySelector=t.appendChild=t.toggleAttribute=t.attributeEquals=t.hasAttribute=t.removeAttribute=t.setAttribute=t.getAttribute=void 0;var o=n(0),i=t.getAttribute=(0,o.curry)(function(e,t){return t.getAttribute(e)}),r=t.setAttribute=(0,o.curry)(function(e,t,n){return n.setAttribute(e,t)}),a=(t.removeAttribute=(0,o.curry)(function(e,t){return t.removeAttribute(e)}),t.hasAttribute=(0,o.curry)(function(e,t){return t.hasAttribute(e)}),t.attributeEquals=(0,o.curry)(function(e,t,n){return n.getAttribute(e)===t}),t.toggleAttribute=(0,o.curry)(function(e,t){var n=i(e,t);r(e,(0,o.inverseBooleanString)(n),t)}),t.appendChild=(0,o.curry)(function(e,t){return e.appendChild(t)}),t.querySelector=(0,o.curry)(function(e,t){return t.querySelector(e)}),t.nodeListToArray=function(e){return Array.prototype.slice.call(e)}),s=(t.querySelectorAll=(0,o.curry)(function(e,t){return a(t.querySelectorAll(e))}),t.removeChild=(0,o.curry)(function(e,t){return e.removeChild(t)}),t.classListContains=(0,o.curry)(function(e,t){return t.classList.contains(e)}),t.addClass=(0,o.curry)(function(e,t){return t.classList.add(e)})),l=t.removeClass=(0,o.curry)(function(e,t){return t.classList.remove(e)}),u=t.hide=s("hidden"),c=t.show=l("hidden");t.toggleVisibility=(0,o.curry)(function(e,t){return(e?c:u)(t)}),t.toggleClass=(0,o.curry)(function(e,t,n){n.classList[t?"add":"remove"](e)}),t.createElement=function(e){var t=e.tag,n=e.id,o=e.classes,i=e.attributes,r=document.createElement(t);return n&&(r.id=n),o&&o.forEach(function(e){r.classList.add(e)}),i&&Object.keys(i).forEach(function(e){r.setAttribute(e,i[e])}),r}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){o(this,e)}return i(e,null,[{key:"setElementOpacity",value:function(t,n){e.setOpacity(t,"borderColor",n),e.setOpacity(t,"boxShadow",n),e.setOpacity(t,"background",n)}},{key:"setOpacity",value:function(t,n,o){function i(e,t){switch(e){case"borderColor":return{borderTopColor:t,borderRightColor:t,borderBottomColor:t,borderLeftColor:t};default:var n={};return n[e]=t,n}}if("background"===n)return e.setOpacity(t,"backgroundColor",o),void e.setOpacity(t,"backgroundImage",o);o=void 0===o?1:o/100;var r=t.css(n),a=i(n,"");t.css(a);for(var s in a)break;var l=t.css(s);""!==l&&"none"!==l||(l=r),l=e.setAlphas(l,"rgba(",o),l=e.setAlphas(l,"rgb(",o),t.css(i(n,l))}},{key:"setAlphas",value:function(e,t,n){if(e){for(var o=e.indexOf(t);-1!==o;){var i=e.indexOf(")",o),r=e.substring(o+t.length,i).split(",");r[3]=void 0!==r[3]?parseFloat(r[3])*n:n,e=e.substring(0,o)+"rgba("+r.join(",")+e.substring(i,e.length),o=e.indexOf(t,i)}return e}}},{key:"elementToDraggable",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n]){var o=e[n].findElement(t);if(o)return o.draggable=e[n],o}}},{key:"elementToDropZone",value:function(e,t){for(var n=0;n<e.length;n++)if(e[n].$dropZone.is(t))return e[n]}},{key:"positionToPercentage",value:function(e,t){return{top:100*parseInt(t.css("top"))/e.innerHeight()+"%",left:100*parseInt(t.css("left"))/e.innerWidth()+"%"}}},{key:"addHover",value:function(t,n){t.hover(function(){t.addClass("h5p-draggable-hover"),t.parent().hasClass("h5p-dragging")||e.setElementOpacity(t,n)},function(){t.parent().hasClass("h5p-dragging")||setTimeout(function(){t.removeClass("h5p-draggable-hover"),e.setElementOpacity(t,n)},1)}),e.setElementOpacity(t,n)}},{key:"strip",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}}]),e}();t.default=r},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){var o,i,r=this;w++,this.id=this.contentId=t,H5P.Question.call(r,"dragquestion"),this.options=y.extend(!0,{},{scoreShow:"Check",tryAgain:"Retry",grabbablePrefix:"Grabbable {num} of {total}.",grabbableSuffix:"Placed in dropzone {num}.",dropzonePrefix:"Dropzone {num} of {total}.",noDropzone:"No dropzone",tipLabel:"Show tip.",tipAvailable:"Tip available",correctAnswer:"Correct answer",wrongAnswer:"Wrong answer",feedbackHeader:"Feedback",scoreBarLabel:"You got :num out of :total points",scoreExplanationButtonLabel:"Show score explanation",question:{settings:{questionTitle:"Drag and drop",showTitle:!0,size:{width:620,height:310}},task:{elements:[],dropZones:[]}},overallFeedback:[],behaviour:{enableRetry:!0,preventResize:!1,singlePoint:!1,showSolutionsRequiresInput:!0,applyPenalties:!0,enableScoreExplanation:!0,dropZoneHighlighting:"dragging",autoAlignSpacing:2,showScorePoints:!0}},e),this.options.behaviour.singlePoint&&(this.options.behaviour.enableScoreExplanation=!1),this.draggables=[],this.dropZones=[],this.answered=n&&void 0!==n.previousState&&void 0!==n.previousState.answers&&n.previousState.answers.length,this.blankIsCorrect=!0,this.backgroundOpacity=void 0===this.options.behaviour.backgroundOpacity||""===this.options.behaviour.backgroundOpacity.trim()?void 0:this.options.behaviour.backgroundOpacity,r.$noDropZone=y('<div class="h5p-dq-no-dz" role="button" style="display:none;"><span class="h5p-hidden-read">'+r.options.noDropzone+"</span></div>");var a=k(r.draggables,r.dropZones,r.$noDropZone[0]),s=function(e){for(var t=0;t<a.drop.elements.length;t++)a.drop.elements[t].setAttribute("aria-dropeffect",e)},l=[],u=this.options.question.task;for(this.correctDZs=[],o=0;o<u.dropZones.length;o++){l.push(!0);var c=u.dropZones[o].correctElements;for(i=0;i<c.length;i++){var d=c[i];void 0===this.correctDZs[d]&&(this.correctDZs[d]=[]),this.correctDZs[d].push(o)}}this.weight=1;var h={prefix:r.options.grabbablePrefix.replace("{total}",u.elements.length),suffix:r.options.grabbableSuffix,correctAnswer:r.options.correctAnswer,wrongAnswer:r.options.wrongAnswer};for(o=0;o<u.elements.length;o++){var p=u.elements[o];if(void 0!==p.dropZones&&p.dropZones.length){void 0!==this.backgroundOpacity&&(p.backgroundOpacity=this.backgroundOpacity);var g=null;n&&void 0!==n.previousState&&void 0!==n.previousState.answers&&void 0!==n.previousState.answers[o]&&(g=n.previousState.answers[o]);var v=new m.default(p,o,g,h),x="dragging"===r.options.behaviour.dropZoneHighlighting;for(v.on("elementadd",function(e){a.drag.addElement(e.data)}),v.on("elementremove",function(e){a.drag.removeElement(e.data),"true"===e.data.getAttribute("aria-grabbed")&&(a.drag.firesEvent("select",e.data),e.data.removeAttribute("aria-grabbed"))}),v.on("focus",function(e){a.drag.setTabbable(e.data),e.data.focus()}),v.on("dragstart",function(e){x&&r.$container.addClass("h5p-dq-highlight-dz"),s(e.data)}),v.on("dragend",function(){x&&r.$container.removeClass("h5p-dq-highlight-dz"),s("none")}),v.on("interacted",function(){r.answered=!0,r.triggerXAPIScored(r.getScore(),r.getMaxScore(),"interacted")}),v.on("leavingDropZone",function(e){r.dropZones[e.data.dropZone].removeAlignable(e.data.$)}),this.draggables[o]=v,i=0;i<p.dropZones.length;i++)l[p.dropZones[i]]=!1}}this.numDropZonesWithoutElements=0;var E={prefix:r.options.dropzonePrefix.replace("{total}",u.dropZones.length),tipLabel:r.options.tipLabel,tipAvailable:r.options.tipAvailable};for(o=0;o<u.dropZones.length;o++){var A=u.dropZones[o];!0===l[o]&&(this.numDropZonesWithoutElements+=1),this.blankIsCorrect&&A.correctElements.length&&(this.blankIsCorrect=!1),A.autoAlign={enabled:A.autoAlign,spacing:r.options.behaviour.autoAlignSpacing,size:r.options.question.settings.size},this.dropZones[o]=new b.default(A,o,E),this.dropZones[o].on("elementaligned",function(e){for(var t=e.data,n=0;n<r.draggables.length;n++){var o=r.draggables[n];if(o&&o.elements&&o.elements.length)for(var i=0;i<o.elements.length;i++){var a=o.elements[i];if(a&&a.$[0]===t[0])return void(a.position=f.default.positionToPercentage(r.$container,a.$))}}})}this.on("resize",r.resize,r),this.on("domChanged",function(e){r.contentId===e.data.contentId&&r.trigger("resize")}),this.on("enterFullScreen",function(){r.$container&&(r.$container.parents(".h5p-content").css("height","100%"),r.trigger("resize"))}),this.on("exitFullScreen",function(){r.$container&&(r.$container.parents(".h5p-content").css("height","auto"),r.trigger("resize"))})}var r=n(4),a=o(r),s=n(6),l=o(s),u=n(7),c=o(u),d=n(8),h=o(d),p=n(2),f=o(p),g=n(9),b=o(g),v=n(10),m=o(v),y=H5P.jQuery,w=0;i.prototype=Object.create(H5P.Question.prototype),i.prototype.constructor=i,i.prototype.registerDomElements=function(){var e=this;e.options.question.settings.showTitle&&(e.$introduction=y('<p class="h5p-dragquestion-introduction" id="dq-intro-'+w+'">'+e.options.question.settings.questionTitle+"</p>"),e.setIntroduction(e.$introduction));var t="";if(void 0!==this.options.question.settings.background&&(t+="h5p-dragquestion-has-no-background"),"always"===e.options.behaviour.dropZoneHighlighting&&(t&&(t+=" "),t+="h5p-dq-highlight-dz-always"),e.setContent(e.createQuestionContent(),{class:t}),!1!==H5P.canHasFullScreen&&this.options.behaviour.enableFullScreen){var n=function(){H5P.isFullscreen?H5P.exitFullScreen(e.$container):H5P.fullScreen(e.$container.parent().parent(),e)},o=y("<div/>",{class:"h5p-my-fullscreen-button-enter",title:this.options.localize.fullscreen,role:"button",tabindex:0,on:{click:n,keypress:function(e){13!==e.which&&32!==e.which||(n(),e.preventDefault())}},prependTo:this.$container.parent()});this.on("enterFullScreen",function(){o.attr("class","h5p-my-fullscreen-button-exit"),o.attr("title",this.options.localize.exitFullscreen)}),this.on("exitFullScreen",function(){o.attr("class","h5p-my-fullscreen-button-enter"),o.attr("title",this.options.localize.fullscreen)})}e.registerButtons(),setTimeout(function(){e.trigger("resize")},200)},i.prototype.getXAPIData=function(){var e=this.createXAPIEventTemplate("answered");return this.addQuestionToXAPI(e),this.addResponseToXAPI(e),{statement:e.data.statement}},i.prototype.addQuestionToXAPI=function(e){var t=e.getVerifiedStatementValue(["object","definition"]);y.extend(t,this.getXAPIDefinition())},i.prototype.getXAPIDefinition=function(){var e={};e.description={"en-US":y("<div>"+this.options.question.settings.questionTitle+"</div>").text()},e.type="http://adlnet.gov/expapi/activities/cmi.interaction",e.interactionType="matching",e.source=[];for(var t=0;t<this.options.question.task.elements.length;t++){var n=this.options.question.task.elements[t];if(n.dropZones&&n.dropZones.length){var o=n.type.params.alt?n.type.params.alt:n.type.params.text;e.source.push({id:""+t,description:{"en-US":y("<div>"+o+"</div>").text()}})}}e.correctResponsesPattern=[""],e.target=[];var i=!0;for(t=0;t<this.options.question.task.dropZones.length;t++)if(e.target.push({id:""+t,description:{"en-US":y("<div>"+this.options.question.task.dropZones[t].label+"</div>").text()}}),this.options.question.task.dropZones[t].correctElements)for(var r=0;r<this.options.question.task.dropZones[t].correctElements.length;r++)i||(e.correctResponsesPattern[0]+="[,]"),e.correctResponsesPattern[0]+=t+"[.]"+this.options.question.task.dropZones[t].correctElements[r],i=!1;return e},i.prototype.addResponseToXAPI=function(e){var t=this.getMaxScore(),n=this.getScore(),o=n==t;e.setScoredResult(n,t,this,!0,o),e.data.statement.result.response=this.getUserXAPIResponse()},i.prototype.getUserXAPIResponse=function(){var e=this.getUserAnswers();return e?e.filter(function(e){return e.elements.length}).map(function(e,t){return e.elements.filter(function(e){return void 0!==e.dropZone}).map(function(e){return e.dropZone+"[.]"+t}).join("[,]")}).filter(function(e){return void 0!==e&&""!==e}).join("[,]"):""},i.prototype.getUserAnswers=function(){return this.draggables.map(function(e,t){return{index:t,draggable:e}}).filter(function(e){return void 0!==e.draggable&&e.draggable.elements}).map(function(e){return{index:e.index,elements:e.draggable.elements}})},i.prototype.createQuestionContent=function(){var e;this.$container=y('<div class="h5p-inner" role="application" aria-labelledby="dq-intro-'+w+'"></div>'),void 0!==this.options.question.settings.background&&this.$container.css("backgroundImage",'url("'+H5P.getPath(this.options.question.settings.background.path,this.id)+'")');var t=this.options.question.task;for(e=0;e<t.elements.length;e++){var n=t.elements[e];if(void 0!==n.dropZones&&0!==n.dropZones.length)this.draggables[e].appendTo(this.$container,this.id);else{var o=this.addElement(n,"static",e);H5P.newRunnable(n.type,this.id,o);!function(e,t){setTimeout(function(){f.default.setOpacity(e,"background",t.backgroundOpacity)},0)}(o,n)}}for(this.$noDropZone.appendTo(this.$container),e=0;e<this.dropZones.length;e++)this.dropZones[e].appendTo(this.$container,this.draggables);return this.$container},i.prototype.registerButtons=function(){this.addSolutionButton(),this.addRetryButton()},i.prototype.addSolutionButton=function(){var e=this;this.addButton("check-answer",this.options.scoreShow,function(){e.answered=!0,e.showAllSolutions(),e.showScore(),e.addExplanation();var t=e.createXAPIEventTemplate("answered");e.addQuestionToXAPI(t),e.addResponseToXAPI(t),e.trigger(t),(e.$introduction?e.$introduction:e.$container.children().first()).focus()})},i.prototype.addExplanation=function(){var e=this,t=this.options.question.task,n=[];t.dropZones.forEach(function(t,o){var i={correct:t.tipsAndFeedback.feedbackOnCorrect,incorrect:t.tipsAndFeedback.feedbackOnIncorrect};if(void 0!==i.correct||void 0!==i.incorrect){var r=t.correctElements,a={};e.draggables.forEach(function(e){e.elements.forEach(function(t){t.dropZone==o&&(a[e.id]={instance:e,correct:-1!==r.indexOf(""+e.id)})})}),Object.keys(a).forEach(function(e){var r=a[e],s=f.default.strip(r.instance.type.params.alt||r.instance.type.params.text)||"?",l=f.default.strip(t.label);r.correct&&i.correct?(n.push({correct:l+" + "+s,text:i.correct}),r.instance.setFeedback(i.correct,o)):!r.correct&&i.incorrect&&(n.push({correct:l+" + ",wrong:s,text:i.incorrect}),r.instance.setFeedback(i.incorrect,o))})}}),0!==n.length&&this.setExplanation(n,this.options.feedbackHeader)},i.prototype.addRetryButton=function(){var e=this;this.addButton("try-again",this.options.tryAgain,function(){e.resetTask(),e.showButton("check-answer"),e.hideButton("try-again")},!1)},i.prototype.addElement=function(e,t,n){return y('<div class="h5p-'+t+'" style="left:'+e.x+"%;top:"+e.y+"%;width:"+e.width+"em;height:"+e.height+'em"></div>').appendTo(this.$container).data("id",n)},i.prototype.resize=function(e){var t=this;if(void 0!==this.$container&&this.$container.is(":visible")){var n=e&&e.data&&e.data.decreaseSize;n||(this.$container.css("height","99999px"),t.$container.parents(".h5p-standalone.h5p-dragquestion").css("width",""));var o=this.options.question.settings.size,i=o.width/o.height,r=this.$container.parent(),a=r.width()-parseFloat(r.css("margin-left"))-parseFloat(r.css("margin-right")),s=t.$container.parents(".h5p-standalone.h5p-dragquestion.h5p-semi-fullscreen");if(s.length){s.css("width",""),n||(t.$container.css("width","10px"),s.css("width",""),setTimeout(function(){t.trigger("resize",{decreaseSize:!0})},200));var l=y(window.frameElement);if(l){a=l.parent().width(),s.css("width",a+"px")}}var u=a/i;a<=0&&(a=o.width,u=o.height),this.$container.css({width:a+"px",height:u+"px",fontSize:a/o.width*16+"px"})}},i.prototype.disableDraggables=function(){this.draggables.forEach(function(e){e.disable()})},i.prototype.enableDraggables=function(){this.draggables.forEach(function(e){e.enable()})},i.prototype.getDropzoneWithoutAnswer=function(e,t){var n=[];return t.forEach(function(e){e.length&&e.forEach(function(e){n.indexOf(e)<0&&n.push(e)})}),e-n.length-this.numDropZonesWithoutElements},i.prototype.showAllSolutions=function(e){this.points=0,this.rawPoints=0;var t=this.getDropzoneWithoutAnswer(this.dropZones.length,this.correctDZs);this.points+=t,this.rawPoints+=t;var n;!e&&this.options.behaviour.showScorePoints&&!this.options.behaviour.singlePoint&&this.options.behaviour.applyPenalties&&(n=new H5P.Question.ScorePoints);for(var o=0;o<this.draggables.length;o++){var i=this.draggables[o];void 0!==i&&(e||i.disable(),this.points+=i.results(e,this.correctDZs[o],n),this.rawPoints+=i.rawPoints)}this.points<0&&(this.points=0),!this.answered&&this.blankIsCorrect&&(this.points=this.weight),this.options.behaviour.singlePoint&&(this.points=this.points===this.calculateMaxScore()?1:0),e||this.hideButton("check-answer"),this.options.behaviour.enableRetry&&!e&&this.showButton("try-again"),!this.hasButton("check-answer")||!1!==this.options.behaviour.enableRetry&&this.points!==this.getMaxScore()||this.hideButton("try-again")},i.prototype.showSolutions=function(){this.showAllSolutions(),this.showScore(),this.hideButton("check-answer"),this.hideButton("try-again"),this.disableDraggables()},i.prototype.resetTask=function(){this.points=0,this.rawPoints=0,this.answered=!1,this.enableDraggables(),this.draggables.forEach(function(e){e.resetPosition()}),this.showButton("check-answer"),this.hideButton("try-again"),this.removeFeedback(),this.setExplanation()},i.prototype.calculateMaxScore=function(){var e=0;if(this.blankIsCorrect)return this.getDropzoneWithoutAnswer(this.dropZones.length,this.correctDZs);e+=this.getDropzoneWithoutAnswer(this.dropZones.length,this.correctDZs);for(var t=this.options.question.task.elements,n=0;n<t.length;n++){var o=this.correctDZs[n];void 0!==o&&o.length&&(t[n].multiple?e+=o.length:e++)}return e},i.prototype.getMaxScore=function(){return this.options.behaviour.singlePoint?this.weight:this.calculateMaxScore()},i.prototype.getScore=function(){this.showAllSolutions(!0);var e=this.options.behaviour.applyPenalties||this.options.behaviour.singlePoint?this.points:this.rawPoints;return delete this.points,delete this.rawPoints,e},i.prototype.getAnswerGiven=function(){return!this.options.behaviour.showSolutionsRequiresInput||this.answered||this.blankIsCorrect},i.prototype.showScore=function(){var e=this.calculateMaxScore();this.options.behaviour.singlePoint&&(e=1);var t=this.options.behaviour.applyPenalties||this.options.behaviour.singlePoint?this.points:this.rawPoints,n=H5P.Question.determineOverallFeedback(this.options.overallFeedback,t/e).replace("@score",t).replace("@total",e),o=!(!this.options.behaviour.enableScoreExplanation||!this.options.behaviour.applyPenalties)&&this.options.scoreExplanation;this.setFeedback(n,t,e,this.options.scoreBarLabel,o,void 0,this.options.scoreExplanationButtonLabel)},i.prototype.getCurrentState=function(){for(var e={answers:[]},t=0;t<this.draggables.length;t++){var n=this.draggables[t];if(void 0!==n){for(var o=[],i=0;i<n.elements.length;i++){var r=n.elements[i];void 0!==r&&void 0!==r.dropZone&&o.push({x:Number(r.position.left.replace("%","")),y:Number(r.position.top.replace("%","")),dz:r.dropZone})}o.length&&(e.answers[t]=o)}}return e},i.prototype.getCopyrights=function(){var e=this,t=new H5P.ContentCopyrights,n=e.options.question.settings.background;if(void 0!==n&&void 0!==n.copyright){var o=new H5P.MediaCopyright(n.copyright);o.setThumbnail(new H5P.Thumbnail(H5P.getPath(n.path,e.id),n.width,n.height)),t.addMedia(o)}for(var i=0;i<e.options.question.task.elements.length;i++){var r=e.options.question.task.elements[i],a=H5P.newRunnable(r.type,e.id);if(void 0!==a.getCopyrights){var s=a.getCopyrights();s.setLabel((r.dropZones.length?"Draggable ":"Static ")+(void 0!==r.type.params.contentName?r.type.params.contentName:"element")),t.addContent(s)}}return t},i.prototype.getTitle=function(){return H5P.createTitle(this.options.question.settings.questionTitle)};var k=function(e,t,n){var o={drag:new a.default([new h.default,new l.default]),drop:new a.default([new h.default,new c.default])};o.drag.useNegativeTabIndex(),o.drop.useNegativeTabIndex();var i,r=function(){i.draggable.trigger("dragend"),i.element.$.removeClass("h5p-draggable-hover"),f.default.setElementOpacity(i.element.$,i.draggable.backgroundOpacity),-1!==o.drop.elements.indexOf(n)&&(o.drop.removeElement(n),n.style.display="none");for(var e=0;e<t.length;e++){var r=t[e];r.dehighlight(),-1!==o.drop.elements.indexOf(r.$dropZone[0])&&o.drop.removeElement(r.$dropZone[0])}if(i.element.$.is(":visible"))i.element.$.focus();else{var a=i.draggable.elements[i.draggable.elements.length-1].$;o.drag.setTabbable(a[0]),a.focus()}i=void 0};return o.drag.on("select",function(a){var s=f.default.elementToDraggable(e,a.element);if(i)return void r();i=s,i.element.$.addClass("h5p-draggable-hover"),f.default.setElementOpacity(i.element.$,i.draggable.backgroundOpacity),i.draggable.trigger("dragstart",i.draggable.mustCopyElement(i.element)?"copy":"move"),o.drop.addElement(n),n.style.display="block",n.style.left=i.draggable.x+"%",n.style.top=i.draggable.y+"%",n.style.width=i.draggable.width+"em",n.style.height=i.draggable.height+"em";for(var l,u=0;u<t.length;u++){var c=t[u];c.accepts(i.draggable,e)&&(c.highlight(),o.drop.addElement(c.$dropZone[0]),l&&i.element.dropZone!==c.id||(l=c.$dropZone))}l&&(o.drop.setTabbable(l[0]),l.focus())}),o.drop.on("select",function(e){if(i){if(e.element===n)return void 0!==i.element.dropZone&&i.element.reset(),i.draggable.multiple||(i.element.$.css({left:i.draggable.x+"%",top:i.draggable.y+"%",width:i.draggable.width+"em",height:i.draggable.height+"em"}),i.draggable.updatePlacement(i.element)),i.element.$[0].setAttribute("aria-grabbed","false"),void r();var o=f.default.elementToDropZone(t,e.element);i.draggable.mustCopyElement(i.element)&&i.element.clone(),i.draggable.addToDropZone(i.index,i.element,o.id),i.element.$.css({left:o.x+"%",top:o.y+"%"}),-1===o.getIndexOf(i.element.$)&&o.alignables.push(i.element.$),o.autoAlign(),i.element.$[0].setAttribute("aria-grabbed","false"),r()}}),o};H5P.DragQuestion=i},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(1),s=n(0),l=n(5),u=(0,a.removeAttribute)("tabindex"),c=((0,s.forEach)(u),(0,a.setAttribute)("tabindex","0")),d=(0,a.setAttribute)("tabindex","-1"),h=(0,a.hasAttribute)("tabindex"),p=function(){function e(t){o(this,e),i(this,(0,l.Eventful)()),this.plugins=t||[],this.elements=[],this.negativeTabIndexAllowed=!1,this.on("nextElement",this.nextElement,this),this.on("previousElement",this.previousElement,this),this.initPlugins()}return r(e,[{key:"addElement",value:function(e){this.elements.push(e),this.firesEvent("addElement",e),1===this.elements.length&&this.setTabbable(e)}},{key:"removeElement",value:function(e){this.elements=(0,s.without)([e],this.elements),h(e)&&(this.setUntabbable(e),this.elements[0]&&this.setTabbable(this.elements[0])),this.firesEvent("removeElement",e)}},{key:"firesEvent",value:function(e,t){var n=this.elements.indexOf(t);return this.fire(e,{element:t,index:n,elements:this.elements,oldElement:this.tabbableElement})}},{key:"nextElement",value:function(e){var t=e.index,n=t===this.elements.length-1,o=this.elements[n?0:t+1];this.setTabbable(o),o.focus()}},{key:"setTabbable",value:function(e){(0,s.forEach)(this.setUntabbable.bind(this),this.elements),c(e),this.tabbableElement=e}},{key:"setUntabbable",value:function(e){this.negativeTabIndexAllowed?d(e):u(e)}},{key:"previousElement",value:function(e){var t=e.index,n=0===t,o=this.elements[n?this.elements.length-1:t-1];this.setTabbable(o),o.focus()}},{key:"useNegativeTabIndex",value:function(){this.negativeTabIndexAllowed=!0,this.elements.forEach(function(e){e.hasAttribute("tabindex")||d(e)})}},{key:"initPlugins",value:function(){this.plugins.forEach(function(e){void 0!==e.init&&e.init(this)},this)}}]),e}();t.default=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Eventful=function(){return{listeners:{},on:function(e,t,n){var o={listener:t,scope:n};return this.listeners[e]=this.listeners[e]||[],this.listeners[e].push(o),this},fire:function(e,t){return(this.listeners[e]||[]).every(function(e){return!1!==e.listener.call(e.scope||this,t)})},propagate:function(e,t){var n=this;e.forEach(function(e){return t.on(e,function(t){return n.fire(e,t)})})}}}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),a=n(0),s=(0,r.setAttribute)("aria-grabbed"),l=(0,r.attributeEquals)("aria-grabbed","true"),u=(0,a.filter)((0,r.hasAttribute)("aria-grabbed")),c=(0,a.compose)((0,a.forEach)((0,r.setAttribute)("aria-grabbed","false")),u),d=(0,a.compose)((0,a.some)(l),u),h=function(){function e(){o(this,e)}return i(e,[{key:"init",value:function(e){this.controls=e,this.controls.on("select",this.select,this)}},{key:"addElement",value:function(e){s("false",e),this.controls.addElement(e)}},{key:"setAllGrabbedToFalse",value:function(){c(this.controls.elements)}},{key:"hasAnyGrabbed",value:function(){return d(this.controls.elements)}},{key:"select",value:function(e){var t=e.element,n=l(t);this.setAllGrabbedToFalse(),n||s("true",t)}}]),e}();t.default=h},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1),a=n(0),s=(0,r.setAttribute)("aria-dropeffect","none"),l=(0,r.setAttribute)("aria-dropeffect","move"),u=(0,a.filter)((0,r.hasAttribute)("aria-dropeffect")),c=(0,a.compose)((0,a.forEach)(l),u),d=(0,a.compose)((0,a.forEach)(s),u),h=function(){function e(){o(this,e)}return i(e,[{key:"init",value:function(e){this.controls=e}},{key:"setAllToMove",value:function(){c(this.controls.elements)}},{key:"setAllToNone",value:function(){d(this.controls.elements)}}]),e}();t.default=h,h.DropEffect={COPY:"copy",MOVE:"move",EXECUTE:"execute",POPUP:"popup",NONE:"none"}},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(){o(this,e),this.selectability=!0}return i(e,[{key:"init",value:function(e){this.boundHandleKeyDown=this.handleKeyDown.bind(this),this.controls=e,this.controls.on("addElement",this.listenForKeyDown,this),this.controls.on("removeElement",this.removeKeyDownListener,this)}},{key:"listenForKeyDown",value:function(e){e.element.addEventListener("keydown",this.boundHandleKeyDown)}},{key:"removeKeyDownListener",value:function(e){e.element.removeEventListener("keydown",this.boundHandleKeyDown)}},{key:"handleKeyDown",value:function(e){switch(e.which){case 13:case 32:this.select(e.target),e.preventDefault();break;case 37:case 38:this.hasChromevoxModifiers(e)||(this.previousElement(e.target),e.preventDefault());break;case 39:case 40:this.hasChromevoxModifiers(e)||(this.nextElement(e.target),e.preventDefault())}}},{key:"hasChromevoxModifiers",value:function(e){return e.shiftKey||e.ctrlKey}},{key:"previousElement",value:function(e){this.controls.firesEvent("previousElement",e)}},{key:"nextElement",value:function(e){this.controls.firesEvent("nextElement",e)}},{key:"select",value:function(e){this.selectability&&!1!==this.controls.firesEvent("before-select",e)&&(this.controls.firesEvent("select",e),this.controls.firesEvent("after-select",e))}},{key:"disableSelectability",value:function(){this.selectability=!1}},{key:"enableSelectability",value:function(){this.selectability=!0}}]),e}();t.default=r},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(2),a=function(e){return e&&e.__esModule?e:{default:e}}(r),s=H5P.jQuery,l=function(){function e(t,n,i){o(this,e);var r=this;H5P.EventDispatcher.call(r),r.id=n,r.showLabel=t.showLabel,r.label=t.label,r.x=t.x,r.y=t.y,r.width=t.width,r.height=t.height,r.backgroundOpacity=t.backgroundOpacity,r.tip=t.tipsAndFeedback.tip||"",r.single=t.single,r.autoAlignable=t.autoAlign,r.alignables=[],r.l10n=i}return i(e,[{key:"appendTo",value:function(e,t){var n=this,o='<div class="h5p-inner"></div>',i="";n.showLabel&&(o='<div class="h5p-label">'+n.label+'<span class="h5p-hidden-read"></span></div>'+o,i=" h5p-has-label"),o='<span class="h5p-hidden-read">'+n.l10n.prefix.replace("{num}",n.id+1)+"</span>"+o,n.$dropZone=s("<div/>",{class:"h5p-dropzone"+i,tabindex:"-1",role:"button","aria-disabled":!0,css:{left:n.x+"%",top:n.y+"%",width:n.width+"em",height:n.height+"em"},html:o}).appendTo(e).children(".h5p-inner").droppable({activeClass:"h5p-active",tolerance:"intersect",accept:function(e){var o=a.default.elementToDraggable(t,e);return!!o&&n.accepts(o.draggable,t)},drop:function(e,t){var o=s(this);a.default.setOpacity(o.removeClass("h5p-over"),"background",n.backgroundOpacity),t.draggable.data("addToZone",n.id),-1===n.getIndexOf(t.draggable)&&n.alignables.push(t.draggable),n.autoAlignable.enabled&&n.autoAlign()},over:function(){a.default.setOpacity(s(this).addClass("h5p-over"),"background",n.backgroundOpacity)},out:function(){a.default.setOpacity(s(this).removeClass("h5p-over"),"background",n.backgroundOpacity)}}).end().focus(function(){r instanceof H5P.jQuery&&r.attr("tabindex","0")}).blur(function(){r instanceof H5P.jQuery&&r.attr("tabindex","-1")});var r=H5P.JoubelUI.createTip(n.tip,{tipLabel:n.l10n.tipLabel,tabcontrol:!0});r instanceof H5P.jQuery&&s("<span/>",{class:"h5p-dq-tipwrap","aria-label":n.l10n.tipAvailable,append:r,appendTo:n.$dropZone}),t.forEach(function(e){var t=e.element.$;e.isInDropZone(n.id)&&-1===n.getIndexOf(t)&&n.alignables.push(t)}),n.autoAlignable.enabled&&n.autoAlign(),setTimeout(function(){a.default.setOpacity(n.$dropZone.children(".h5p-label"),"background",n.backgroundOpacity),a.default.setOpacity(n.$dropZone.children(".h5p-inner"),"background",n.backgroundOpacity)},0)}},{key:"accepts",value:function(e,t){var n=this;if(!e.hasDropZone(n.id))return!1;if(n.single)for(var o=0;o<t.length;o++)if(t[o]&&t[o].isInDropZone(n.id))return!1;return!0}},{key:"getIndexOf",value:function(e){for(var t=this,n=0;n<t.alignables.length;n++)if(t.alignables[n][0]===e[0])return n;return-1}},{key:"removeAlignable",value:function(e){var t=this,n=t.getIndexOf(e);-1!==n&&(t.alignables.splice(n,1),void 0===t.autoAlignTimer&&(t.autoAlignTimer=setTimeout(function(){delete t.autoAlignTimer,t.autoAlign()},1)))}},{key:"autoAlign",value:function(){for(var e,t,n=this,o=n.$dropZone.parent()[0].getBoundingClientRect(),i={x:n.autoAlignable.spacing/n.autoAlignable.size.width*100,y:n.autoAlignable.spacing/n.autoAlignable.size.height*100},r={x:n.x+i.x,y:n.y+i.y},a=n.$dropZone[0].getBoundingClientRect(),s={x:a.width-2*i.x,y:a.height-2*i.y},l={x:s.x,y:s.y},u=0,c=function(){e.css({left:r.x+"%",top:r.y+"%"}),n.trigger("elementaligned",e);var i=t.width+n.autoAlignable.spacing;l.x-=i,r.x+=i/o.width*100;var a=t.height+n.autoAlignable.spacing;a>u&&(u=a)},d=0;d<n.alignables.length;d++)if(e=n.alignables[d],t=e[0].getBoundingClientRect(),l.x>=t.width)c();else{if(l.x=s.x,r.x=n.x+i.x,u&&(l.y-=u,r.y+=u/o.height*100,u=0),l.y<=0)return;c()}}},{key:"highlight",value:function(){this.$dropZone.attr("aria-disabled","false").children(".h5p-inner").addClass("h5p-active")}},{key:"dehighlight",value:function(){this.$dropZone.attr("aria-disabled","true").children(".h5p-inner").removeClass("h5p-active")}}]),e}();t.default=l},function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(2),l=function(e){return e&&e.__esModule?e:{default:e}}(s),u=H5P.jQuery,c=function(e){function t(e,n,r,a){o(this,t);var s=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),l=s;if(l.$=u(l),l.id=n,l.elements=[],l.x=e.x,l.y=e.y,l.width=e.width,l.height=e.height,l.backgroundOpacity=e.backgroundOpacity,l.dropZones=e.dropZones,l.type=e.type,l.multiple=e.multiple,l.l10n=a,r){l.multiple&&l.elements.push({});for(var c=0;c<r.length;c++)l.elements.push({dropZone:r[c].dz,position:{left:r[c].x+"%",top:r[c].y+"%"}})}return s}return r(t,e),a(t,[{key:"appendTo",value:function(e,t){var n=this;if(n.elements.length)for(var o=0;o<n.elements.length;o++)n.attachElement(o,e,t);else n.attachElement(null,e,t)}},{key:"attachElement",value:function(e,t,n){var o,i=this;null===e?(o={},i.elements.push(o),e=i.elements.length-1):o=i.elements[e],u.extend(o,{clone:function(){i.attachElement(null,t,n)},reset:function(){void 0!==o.dropZone&&(i.trigger("leavingDropZone",o),delete o.dropZone),i.multiple&&(o.$.remove(),delete i.elements[e],i.trigger("elementremove",o.$[0])),delete o.position}}),o.$=u("<div/>",{class:"h5p-draggable",tabindex:"-1",role:"button",css:{left:i.x+"%",top:i.y+"%",width:i.width+"em",height:i.height+"em"},appendTo:t}).on("click",function(){i.trigger("focus",this)}).draggable({revert:function(e){t.removeClass("h5p-dragging");var n=u(this);return n.data("uiDraggable").originalPosition={top:i.y+"%",left:i.x+"%"},i.updatePlacement(o),n[0].setAttribute("aria-grabbed","false"),i.trigger("dragend"),!e},start:function(){var e=u(this),n=i.mustCopyElement(o);n&&o.clone(),e.removeClass("h5p-wrong").detach().appendTo(t),t.addClass("h5p-dragging"),l.default.setElementOpacity(e,i.backgroundOpacity),this.setAttribute("aria-grabbed","true"),i.trigger("focus",this),i.trigger("dragstart",{element:this,effect:n?"copy":"move"})},stop:function(){var n=u(this);o.position=l.default.positionToPercentage(t,n),n.css(o.position);var r=n.data("addToZone");void 0!==r?(n.removeData("addToZone"),i.addToDropZone(e,o,r)):o.reset()}}).css("position",""),i.element=o,o.position&&(o.$.css(o.position),i.updatePlacement(o)),l.default.addHover(o.$,i.backgroundOpacity),H5P.newRunnable(i.type,n,o.$),u('<span class="h5p-hidden-read">'+i.l10n.prefix.replace("{num}",i.id+1)+"</span>").prependTo(o.$),u('<span class="h5p-hidden-read"></span>').appendTo(o.$),setTimeout(function(){l.default.setElementOpacity(o.$,i.backgroundOpacity)},0),i.trigger("elementadd",o.$[0])}},{key:"setFeedback",value:function(e,t){this.elements.forEach(function(n){n.dropZone===t&&(void 0===n.$feedback&&(n.$feedback=u("<span>",{class:"h5p-hidden-read",appendTo:n.$})),n.$feedback.html(e))})}},{key:"mustCopyElement",value:function(e){return this.multiple&&void 0===e.dropZone}},{key:"hasDropZone",value:function(e){for(var t=this,n=0;n<t.dropZones.length;n++)if(parseInt(t.dropZones[n])===e)return!0;return!1}},{key:"addToDropZone",value:function(e,t,n){var o=this;if(o.multiple)for(var i=0;i<o.elements.length;i++)if(i!==e&&void 0!==o.elements[i]&&o.elements[i].dropZone===n)return void 0!==o.elements[e].dropZone&&o.elements[e].dropZone!==n&&o.trigger("leavingDropZone",t),t.$.remove(),delete o.elements[e],void o.trigger("elementremove",this.element.$[0]);void 0!==t.dropZone&&t.dropZone!==n&&o.trigger("leavingDropZone",t),t.dropZone=n,o.updatePlacement(t),o.trigger("interacted")}},{key:"updatePlacement",value:function(e){e.$suffix&&e.$suffix.remove(),void 0!==e.dropZone?(e.$.addClass("h5p-dropped"),l.default.setElementOpacity(e.$,self.backgroundOpacity),e.$suffix=u('<span class="h5p-hidden-read">'+this.l10n.suffix.replace("{num}",e.dropZone+1)+". </span>").appendTo(e.$)):(e.$.removeClass("h5p-dropped").removeClass("h5p-wrong").removeClass("h5p-correct").css({border:"",background:""}),l.default.setElementOpacity(e.$,this.backgroundOpacity))}},{key:"resetPosition",value:function(){var e=this;this.elements.forEach(function(t){if(t.$feedback&&(t.$feedback.remove(),delete t.$feedback),void 0!==t.dropZone){var n=t.$;n.animate({left:e.x+"%",top:e.y+"%"},function(){e.multiple&&(void 0!==n.dropZone&&e.trigger("leavingDropZone",n),n.remove(),e.elements.indexOf(t)>=0&&delete e.elements[e.elements.indexOf(t)],e.trigger("elementremove",n[0]))}),e.updatePlacement(t)}}),void 0!==e.element.dropZone&&(e.trigger("leavingDropZone",e.element),delete e.element.dropZone),e.updatePlacement(e.element)}},{key:"findElement",value:function(e){for(var t=this,n=0;n<t.elements.length;n++)if(void 0!==t.elements[n]&&t.elements[n].$.is(e))return{element:t.elements[n],index:n}}},{key:"isInDropZone",value:function(e){for(var t=this,n=0;n<t.elements.length;n++)if(void 0!==t.elements[n]&&t.elements[n].dropZone===e)return!0;return!1}},{key:"disable",value:function(){for(var e=this,t=0;t<e.elements.length;t++){var n=e.elements[t];n&&(n.$.draggable("disable"),e.trigger("elementremove",n.$[0]))}}},{key:"enable",value:function(){for(var e=this,t=0;t<e.elements.length;t++){var n=e.elements[t];n&&(n.$.draggable("enable"),e.trigger("elementadd",n.$[0]))}}},{key:"results",value:function(e,t,n){var o,i,r,a,s=this,l=0;if(s.rawPoints=0,void 0===t){for(o=0;o<s.elements.length;o++)void 0!==(r=s.elements[o])&&void 0!==r.dropZone&&(!0!==e&&s.markElement(r,"wrong",n),l--);return l}for(o=0;o<s.elements.length;o++)if(void 0!==(r=s.elements[o])&&void 0!==r.dropZone){for(a=!1,i=0;i<t.length;i++)if(r.dropZone===t[i]){!0!==e&&s.markElement(r,"correct",n),a=!0,s.rawPoints++,l++;break}a||(!0!==e&&s.markElement(r,"wrong",n),l--)}return l}},{key:"markElement",value:function(e,t,n){var o=u("<span/>",{class:"h5p-hidden-read",html:this.l10n[t+"Answer"]+". "});n&&(o=o.add(n.getElement("correct"===t))),e.$suffix=e.$suffix.add(o),e.$.addClass("h5p-"+t).append(o),l.default.setElementOpacity(e.$,this.backgroundOpacity)}}]),t}(H5P.EventDispatcher);t.default=c}]);